CREATE TABLE SQLD_34_27 ( 
    EMP_ID NUMBER,
    DEPT_ID NUMBER,
    SALARY NUMBER
);

INSERT INTO SQLD_34_27 VALUES (1, 10, 1000);
INSERT INTO SQLD_34_27 VALUES (2, 10, 1500);
INSERT INTO SQLD_34_27 VALUES (3, 10, 1500);
INSERT INTO SQLD_34_27 VALUES (4, 20, 1200);
INSERT INTO SQLD_34_27 VALUES (5, 20, 1100);
INSERT INTO SQLD_34_27 VALUES (6, 20, 100);
INSERT INTO SQLD_34_27 VALUES (7, 30, 4000);
INSERT INTO SQLD_34_27 VALUES (8, 30, 5000);

SELECT * FROM SQLD_34_27;

-- 문제 SQL
SELECT DEPT_ID, SALARY
FROM (SELECT ROW_NUMBER() OVER(PARTITION BY DEPT_ID ORDER BY SALARY DESC) RN, DEPT_ID, SALARY FROM SQLD_34_27)
WHERE RN = 1;

-- 보기 SQL (문제 SQL과 같은 결과 찾기)
-- 1
SELECT DEPT_ID, SALARY
FROM (SELECT RANK() OVER(PARTITION BY DEPT_ID ORDER BY SALARY DESC) RN, DEPT_ID, SALARY FROM SQLD_34_27)
WHERE RN = 1;
-- 2
SELECT DEPT_ID, MAX(SALARY) AS SALARY
FROM SQLD_34_27
GROUP BY DEPT_ID;
-- 3
SELECT DEPT_ID, SALARY
FROM SQLD_34_27
WHERE ROWNUM = 1
ORDER BY DEPT_ID, SALARY DESC;
-- 4
SELECT DEPT_ID, SALARY
FROM SQLD_34_27
WHERE SALARY = (SELECT MAX(SALARY) FROM SQLD_34_27);