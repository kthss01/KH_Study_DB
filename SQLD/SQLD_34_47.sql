CREATE TABLE SQLD_34_47 (
    EMPLOYEE_ID NUMBER,
    LAST_NAME VARCHAR(20),
    MANAGER_ID NUMBER,
    SALARY NUMBER
);

INSERT INTO SQLD_34_47 VALUES (100, 'King', NULL, 24000);
INSERT INTO SQLD_34_47 VALUES (101, 'Kochhar', 100, 17000);
INSERT INTO SQLD_34_47 VALUES (102, 'De Haan', 100, 17000);
INSERT INTO SQLD_34_47 VALUES (103, 'Hunold', 102, 9000);
INSERT INTO SQLD_34_47 VALUES (104, 'Ernst', 103, 6000);
INSERT INTO SQLD_34_47 VALUES (105, 'Austin', 103, 4800);
INSERT INTO SQLD_34_47 VALUES (106, 'Pataballa', 103, 4800);
INSERT INTO SQLD_34_47 VALUES (107, 'Lorentz', 103, 4200);
INSERT INTO SQLD_34_47 VALUES (108, 'Greenberg', 101, 12000);
INSERT INTO SQLD_34_47 VALUES (109, 'Raviet', 108, 9000);

SELECT * FROM SQLD_34_47;

-- SQL 문 수행 결과
-- 해석 : 매니저와 사원 SALARY 각각 합계 (매니저위에 매니저있으면 그거 포함)
WITH WITH_TAB (last_name, EMP_ID, MGR_ID, sum_salary)
AS (
SELECT last_name, EMPLOYEE_ID, MANAGER_ID, salary
FROM SQLD_34_47
WHERE MANAGER_ID IS NULL
UNION ALL
SELECT a.last_name, a.EMPLOYEE_ID, a.MANAGER_ID, a.salary + b.sum_salary
FROM SQLD_34_47 A, WITH_TAB B
WHERE B.EMP_ID = A.MANAGER_ID )
SELECT SUM_SALARY FROM WITH_TAB
WHERE EMP_ID = 105;
